<mat-card class="recurringDeposits-account-card">

  <mat-card-header fxLayout="column" class="header">

    <mat-card-title-group class="header-title-group">

      <div class="profile-image-container">
        <div>
          <img mat-card-md-image class="profile-image" matTooltip="Recurring Deposits Account"
            [src]="'assets/images/recurring-deposits_account_placeholder.png'">
        </div>
      </div>

      <div class="mat-typography account-card-title">
        <mat-card-title>
          <h3>
            <i class="fa fa-stop" [ngClass]="recurringDepositsAccountData.status.code | statusLookup"
              [matTooltip]="recurringDepositsAccountData.status.value"></i>
            <span [translate]="'modulo.labels.accountname'">Account Name </span>: {{recurringDepositsAccountData.depositProductName}}
          </h3>
        </mat-card-title>
        <mat-card-subtitle>
          <p>
            <span [translate]="'modulo.labels.account'">Account</span> #: {{recurringDepositsAccountData.accountNo}} | 
            <span [translate]="'modulo.labels.clientname'">Client Name</span>:
            {{recurringDepositsAccountData.clientName}}<br />
            <span
              *ngIf="!recurringDepositsAccountData.status.rejected && !recurringDepositsAccountData.status.submittedAndPendingApproval">
              <span [translate]="'modulo.labels.currentbalance'">Current Balance</span>:
              {{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;{{recurringDepositsAccountData.summary.accountBalance}}<br />
              <span [translate]="'modulo.labels.availablebalance'">Available Balance</span>:
              {{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;{{recurringDepositsAccountData.summary.availableBalance}}<br />
            </span>
          </p>
        </mat-card-subtitle>
      </div>

    </mat-card-title-group>

    <mat-card-actions class="account-actions">

      <ng-container *ngFor="let button of buttonConfig.singleButtons">
        <button mat-raised-button (click)="doAction(button.name)">
          <i class="{{button.icon}}"></i> {{button.name}}</button>
      </ng-container>

      <ng-container *ngIf="buttonConfig.options.length">
        <button mat-raised-button [matMenuTriggerFor]="More">
          <span [translate]="'labels.buttons.More'">More</span></button>
        <mat-menu #More="matMenu">
        <span *ngFor="let option of buttonConfig.options">
          <button mat-menu-item (click)="doAction(option.name)">{{option.name}}</button>
        </span>
        </mat-menu>
      </ng-container>

    </mat-card-actions>

  </mat-card-header>

  <mat-card-content class="content">

    <div class="recurringDeposits-account-tables" fxLayout="row" fxLayoutGap="2%">

      <div fxFlex="49%"
        *ngIf="!recurringDepositsAccountData.status.rejected && !recurringDepositsAccountData.status.submittedAndPendingApproval">
        <h4 class="table-headers"><span [translate]="'modulo.labels.savingsdetails'">Savings Details</span></h4>
        <table>
          <tbody>
            <tr>
              <td>Field Officer</td>
              <td>{{recurringDepositsAccountData.fieldOfficerName}}<span
                  *ngIf="!recurringDepositsAccountData.fieldOfficerName">
                  <span [translate]="'modulo.labels.unassigned'">Unassigned</span></span></td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.activationdate'">Activation date</span></td>
              <td>{{recurringDepositsAccountData.timeline.activatedOnDate  | dateFormat}}</td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.maturitydate'">Maturity Date</span></td>
              <td><span>{{recurringDepositsAccountData.maturityDate  | dateFormat}}</span></td>
            </tr>
            <tr
              *ngIf="recurringDepositsAccountData.timeline.closedOnDate || recurringDepositsAccountData.summary.totalWitddrawals">
              <td *ngIf="recurringDepositsAccountData.timeline.closedOnDate">
                <span [translate]="'modulo.labels.closedondate'">Closed on Date</span></td>
              <td><span>{{recurringDepositsAccountData.timeline.closedOnDate  | dateFormat}}</span></td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.period'">Period</span></td>
              <td>
                <span>{{recurringDepositsAccountData.depositPeriod}}&nbsp;{{recurringDepositsAccountData.depositPeriodFrequency.value}}</span>
              </td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.depositfrequency'">Deposit Frequency</span></td>
              <td><span>{{recurringDepositsAccountData.recurringFrequency}}
                  &nbsp;{{recurringDepositsAccountData.recurringFrequencyType.value}}
                </span></td>
            </tr>
            <tr *ngIf="recurringDepositsAccountData.minBalanceForInterestCalculation">
              <td><span [translate]="'modulo.labels.balancerequiredinterestcalculation'"> Balance Required For Interest Calculation</span></td>
              <td><span>{{recurringDepositsAccountData.minBalanceForInterestCalculation}}</span></td>
            </tr>
            <tr *ngIf="recurringDepositsAccountData.witdHoldTax">
              <td><span [translate]="'modulo.labels.withholdtaxgroup'"> Witdhold Tax Group </span></td>
              <td><span>{{recurringDepositsAccountData.taxGroup.name}}</span></td>
            </tr>
          </tbody>
        </table>
      </div>

      <div fxFlex="49%"
        *ngIf="!recurringDepositsAccountData.status.rejected && !recurringDepositsAccountData.status.submittedAndPendingApproval">
        <h4 class="table-headers"><span [translate]="'modulo.labels.performancehistory'">Performance History</span></h4>
        <table>
          <tbody>
            <tr>
              <td><span [translate]="'modulo.labels.principalamount'">Principal Amount</span></td>
              <td>
                <span>{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;{{recurringDepositsAccountData.depositAmount}}</span>
              </td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.maturityamount'">Maturity Amount</span></td>
              <td>
                <span>{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;{{recurringDepositsAccountData.maturityAmount | number}}</span>
              </td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.recurringdepositamount'">Recurring Deposit Amount</span></td>
              <td>
                <span>{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;{{recurringDepositsAccountData?.mandatoryRecommendedDepositAmount | number}}</span>
              </td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.depositstilldate'">Deposits till Date</span></td>
              <td><span
                  *ngIf="recurringDepositsAccountData.summary.totalDeposits">{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;{{recurringDepositsAccountData.summary.totalDeposits | number}}</span>
                <span
                  *ngIf="!recurringDepositsAccountData.summary.totalDeposits">{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;0</span>
              </td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.withdrawlstilldate'">Withdrwals till Date</span></td>
              <td><span
                  *ngIf="recurringDepositsAccountData.summary.totalWithdrawals">{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;{{recurringDepositsAccountData.summary.totalWithdrawals | number}}</span>
                <span
                  *ngIf="!recurringDepositsAccountData.summary.totalWithdrawals">{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;0</span>
              </td>
            </tr>

            <tr *ngIf="recurringDepositsAccountData.summary.totalInterestEarned >= 0">
              <td ><span [translate]="'modulo.labels.interestearned'">Interest Earned</span></td>
              <td><span>{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;{{recurringDepositsAccountData.summary.totalInterestEarned| number}}</span>
              </td>
            </tr>

          </tbody>
        </table>
      </div>

      <div fxFlex="49%"
        *ngIf="recurringDepositsAccountData.status.rejected || recurringDepositsAccountData.status.submittedAndPendingApproval">
        <table>
          <tbody>
            <tr>
              <td><span [translate]="'modulo.labels.datedeposit'">Date of Deposit</span></td>
              <td>
                <span *ngIf="!recurringDepositsAccountData.expectedFirstDepositOnDate">{{recurringDepositsAccountData.timeline.activatedOnDate  | dateFormat}}
                  <span *ngIf="!recurringDepositsAccountData.timeline.activatedOnDate">
                    <span [translate]="'modulo.labels.notactivated'">Not Activated</span></span>
                </span>
                <span *ngIf="recurringDepositsAccountData.expectedFirstDepositOnDate" >{{recurringDepositsAccountData.expectedFirstDepositOnDate  | dateFormat}}
                  <span *ngIf="!recurringDepositsAccountData.expectedFirstDepositOnDate">
                    <span [translate]="'modulo.labels.notactivated'">Not Activated</span></span>
                </span>
              </td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.period'">Period</span></td>
              <td>
                <span>{{recurringDepositsAccountData.depositPeriod}}&nbsp;{{recurringDepositsAccountData.depositPeriodFrequency.value}}</span>
              </td>
            </tr>
            <tr *ngIf="recurringDepositsAccountData.maturityDate">
              <td><span [translate]="'modulo.labels.maturitydate'">Maturity Date</span></td>
              <td><span>{{recurringDepositsAccountData.maturityDate  | dateFormat}}</span></td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.totaldeposits'">Total Deposits</span> </td>
              <td>
                <span *ngIf="recurringDepositsAccountData.summary.totalDeposits">{{ recurringDepositsAccountData.currency.displaySymbol }}&nbsp;{{ recurringDepositsAccountData.summary.totalDeposits }}</span>
                <span *ngIf="!recurringDepositsAccountData.summary.totalDeposits">{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;0</span>
              </td>
            </tr>
            <tr >
              <td><span [translate]="'modulo.labels.actualavailablebalance'"> Actual Available Balance</span></td>
              <td>{{ recurringDepositsAccountData.currency.displaySymbol }}&nbsp;{{ recurringDepositsAccountData.summary.accountBalance }}
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.recurringdepositsamount'"> Recurring Deposits Amount</span></td>
              <td>
                {{ recurringDepositsAccountData.currency.displaySymbol }}&nbsp;{{ recurringDepositsAccountData.mandatoryRecommendedDepositAmount }}
            </tr>
            <tr *ngIf="recurringDepositsAccountData.summary.totalInterestEarned">
              <td><span [translate]="'modulo.labels.interestearned'"> Interests Earned</span> </td>
              <td><span>{{ recurringDepositsAccountData.currency.displaySymbol }}&nbsp;{{ recurringDepositsAccountData.summary.totalInterestEarned }}</span></td>
            </tr>
            <tr *ngIf="recurringDepositsAccountData.summary.totalWithdrawals">
              <td> <span [translate]="'modulo.labels.totalwithdrawls'">Total Withdrawls</span> </td>
              <td>
                <span>{{ recurringDepositsAccountData.currency.displaySymbol }}&nbsp;{{ recurringDepositsAccountData.summary.totalWithdrawals }}</span>
              </td>
            </tr>
            <tr *ngIf="recurringDepositsAccountData.minBalanceForInterestCalculation">
              <td><span [translate]="'modulo.labels.balancerequiredinterestcalculation'"> Balance Required For Interest Calculation</span> </td>
              <td>
                <span>{{ recurringDepositsAccountData.minBalanceForInterestCalculation }}</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div fxFlex="49%"
        *ngIf="recurringDepositsAccountData.status.rejected || recurringDepositsAccountData.status.submittedAndPendingApproval">
        <table>
          <tbody>
            <tr>
              <td><span [translate]="'modulo.labels.principalamount'">Principal Amount</span></td>
              <td><span
                  *ngIf="recurringDepositsAccountData.depositAmount">{{ recurringDepositsAccountData.currency.displaySymbol }}&nbsp;{{ recurringDepositsAccountData.depositAmount }}</span>
                <span
                  *ngIf="!recurringDepositsAccountData.depositAmount">{{ recurringDepositsAccountData.currency.displaySymbol }}&nbsp;0</span>
              </td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.rateinterest'">Rate of Interest</span></td>
              <td>
                <span>{{recurringDepositsAccountData.nominalAnnualInterestRate}}</span>
              </td>
            </tr>
            <tr *ngIf="recurringDepositsAccountData.maturityDate">
              <td><span [translate]="'modulo.labels.maturityamount'">Maturity Amount</span></td>
              <td>
                <span>{{ recurringDepositsAccountData.currency.displaySymbol }}&nbsp;{{ recurringDepositsAccountData.maturityAmount }}</span>
              </td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.totalwithdrawls'">Total Withdrawls</span> </td>
              <td>
                <span
                  *ngIf="recurringDepositsAccountData.summary.totalWithdrawals">{{ recurringDepositsAccountData.currency.displaySymbol }}&nbsp;{{ recurringDepositsAccountData.summary.totalWithdrawals }}</span>
                <span
                  *ngIf="!recurringDepositsAccountData.summary.totalWithdrawals">{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;0</span>
              </td>
            </tr>
            <tr *ngIf="recurringDepositsAccountData.timeline.closedOnDate">
              <td><span [translate]="'modulo.labels.closedondate'"> Closed on Date </span></td>
              <td>
                {{ recurringDepositsAccountData.timeline.closedOnDate  | dateFormat }}
            </tr>
            <tr>
              <td> <span [translate]="'modulo.labels.depositsfrequency'">Deposits Frequency</span> </td>
              <td>
                {{ recurringDepositsAccountData.recurringFrequency }}&nbsp;{{ recurringDepositsAccountData.recurringFrequencyType.value }}
            </tr>
            <tr *ngIf="recurringDepositsAccountData.summary.totalInterestEarned">
              <td><span [translate]="'modulo.labels.interestsposted'"> Interests Posted</span> </td>
              <td>
                <span
                  *ngIf="recurringDepositsAccountData.summary.totalInterestPosted">{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;{{recurringDepositsAccountData.summary.totalInterestPosted}}</span>
                <span
                  *ngIf="!recurringDepositsAccountData.summary.totalInterestPosted">{{recurringDepositsAccountData.currency.displaySymbol}}&nbsp;0</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="recurringDeposits-account-tables" fxLayout="row" fxLayoutGap="2%">
      <div fxFlex="49%"
        *ngIf="!recurringDepositsAccountData.status.rejected && !recurringDepositsAccountData.status.submittedAndPendingApproval">
        <h4 class="table-headers"><span [translate]="'modulo.labels.interestdetails'">Interest Details</span></h4>
        <table>
          <tbody>
            <tr>
              <td ><span [translate]="'modulo.labels.interestrate'">Interest Rate</span></td>
              <td><span>{{recurringDepositsAccountData.nominalAnnualInterestRate}}%</span></td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.interestcompoundingperiod'">Interest Compounding period</span></td>
              <td><span>{{recurringDepositsAccountData.interestCompoundingPeriodType.value}}</span></td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.interestpostperiod'">Interest Posting period</span></td>
              <td><span>{{recurringDepositsAccountData.interestPostingPeriodType.value}}</span></td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.interestcalculatedusing'">Interest calculated using</span></td>
              <td><span>{{recurringDepositsAccountData.interestCalculationType.value}}</span></td>
            </tr>
            <tr>
              <td># <span [translate]="'modulo.labels.daysinyear'">Days in Year</span></td>
              <td><span>{{recurringDepositsAccountData.interestCalculationDaysInYearType.value}}</span></td>
            </tr>
            <tr *ngIf="recurringDepositsAccountData.preClosurePenalApplicable">
              <td><span [translate]="'modulo.labels.preclosurepenalinterest'">Pre-closure penal Interest (less)</span></td>
              <td><span>{{recurringDepositsAccountData.preClosurePenalInterest}} % on
                  {{recurringDepositsAccountData.preClosurePenalInterestOnType.value}}</span></td>
            </tr>
          </tbody>
        </table>
      </div>

      <div fxFlex="49%"
        *ngIf="recurringDepositsAccountData.status.rejected || recurringDepositsAccountData.status.submittedAndPendingApproval">
        <table>
          <tbody>
            <tr>
              <td><span [translate]="'modulo.labels.interestcompoundingperiod'">Interest Compounding Period</span></td>
              <td><span>{{recurringDepositsAccountData.interestCompoundingPeriodType.value}}</span></td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.interestpostingperiod'">Interest Posting period</span></td>
              <td><span>{{recurringDepositsAccountData.interestPostingPeriodType.value}}</span></td>
            </tr>
            <tr>
              <td><span [translate]="'modulo.labels.interestcalculatedusing'">Interest calculated using</span></td>
              <td><span>{{recurringDepositsAccountData.interestCalculationType.value}}</span></td>
            </tr>
            <tr>
              <td># <span [translate]="'modulo.labels.daysinyear'">Days in Year</span></td>
              <td><span>{{recurringDepositsAccountData.interestCalculationDaysInYearType.value}}</span></td>
            </tr>
            <tr *ngIf="recurringDepositsAccountData.preClosurePenalApplicable">
              <td><span [translate]="'modulo.labels.preclosurepanalinterest'">Pre-closure penal Interest (less)</span></td>
              <td><span>{{recurringDepositsAccountData.preClosurePenalInterest}} % on
                  {{recurringDepositsAccountData.preClosurePenalInterestOnType.value}}</span></td>
            </tr>
            <tr *ngIf="recurringDepositsAccountData.witdHoldTax">
              <td><span [translate]="'modulo.labels.withholdtaxgroup'"> Witdhold Tax Group</span> </td>
              <td><span>{{recurringDepositsAccountData.taxGroup.name}}</span></td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>

    <nav mat-tab-nav-bar class="navigation-tabs">
        <a mat-tab-link [routerLink]="['./interest-rate-chart']" routerLinkActive #IRC="routerLinkActive"
          [active]="IRC.isActive">
          <span [translate]="'modulo.labels.interestratechart'">Interest Rate Chart</span>
        </a>
        <ng-container *ngIf="recurringDepositsAccountData.transactions">
          <a mat-tab-link [routerLink]="['./transactions']" routerLinkActive #transactions="routerLinkActive"
            [active]="transactions.isActive">
            <span [translate]="'modulo.labels.transactions'">Transactions</span>
          </a>
        </ng-container>
        <a mat-tab-link [routerLink]="['./charges']" routerLinkActive #charges="routerLinkActive" [active]="charges.isActive">
          <span [translate]="'modulo.labels.charges'">Charges</span>
        </a>
        <ng-container *ngIf="recurringDepositsAccountData.clientId">
          <a mat-tab-link [routerLink]="['./standing-instructions-tab']" routerLinkActive #standingInstructions="routerLinkActive"
            [active]="standingInstructions.isActive">
            <span [translate]="'modulo.labels.standinginstructions'">Standing Instructions</span>
          </a>
        </ng-container>
        <ng-container *ngFor="let savingsDatatable of savingsDatatables">
          <a mat-tab-link *mifosxHasPermission="'READ_' + savingsDatatable.registeredTableName"
            [routerLink]="['./datatables',savingsDatatable.registeredTableName]" routerLinkActive #datatable="routerLinkActive"
            [active]="datatable.isActive">
            {{savingsDatatable.registeredTableName}}
          </a>
        </ng-container>
    </nav>

    <router-outlet></router-outlet>

  </mat-card-content>

</mat-card>
