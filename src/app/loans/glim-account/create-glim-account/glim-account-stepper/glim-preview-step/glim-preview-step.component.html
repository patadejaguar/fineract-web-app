<div fxLayout="row wrap" fxLayout.lt-md="column">

    <h3 class="mat-h3" fxFlexFill><span [translate]="'modulo.loans.title.details'">Details</span></h3>
  
    <mat-divider fxFlexFill></mat-divider>
  
    <div fxFlexFill>
      <span fxFlex="40%" [translate]="'modulo.loans.title.product'">Product:</span>
      <span fxFlex="60%">{{ loansAccount.productId | find:loansAccountTemplate.productOptions:'id':'name' }}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.loanOfficerId">
      <span fxFlex="40%" [translate]="'modulo.loans.title.officer'">Loan officer:</span>
      <span
        fxFlex="60%">{{ loansAccount.loanOfficerId | find:loansAccountProductTemplate.loanOfficerOptions:'id':'displayName'}}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.loanPurposeId">
      <span fxFlex="40%" [translate]="'modulo.loans.title.loanpurpose'">Loan purpose:</span>
      <span
        fxFlex="60%">{{ loansAccount.loanPurposeId | find:loansAccountProductTemplate.loanPurposeOptions:'id':'name'}}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.fundId">
      <span fxFlex="40%" [translate]="'modulo.loans.title.fund'">Fund:</span>
      <span fxFlex="60%">{{ loansAccount.fundId | find:loansAccountProductTemplate.fundOptions:'id':'name'}}</span>
    </div>
  
    <div fxFlexFill>
      <span fxFlex="40%" [translate]="'modulo.loans.title.submitted'">Submitted on:</span>
      <span fxFlex="60%">{{ loansAccount.submittedOnDate  | dateFormat }}</span>
    </div>
  
    <div fxFlexFill>
      <span fxFlex="40%" [translate]="'modulo.loans.title.disbursement'">Disbursement on:</span>
      <span fxFlex="60%">{{ loansAccount.expectedDisbursementDate  | dateFormat }}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.externalId">
      <span fxFlex="40%" [translate]="'modulo.loans.title.externalid'">External id:</span>
      <span fxFlex="60%">{{ loansAccount.externalId }}</span>
    </div>
  
    <h3 class="mat-h3" fxFlexFill><span [translate]="'modulo.loans.title.terms'">Terms</span></h3>
  
    <mat-divider fxFlexFill></mat-divider>
  
    <div fxFlexFill>
      <span fxFlex="40%" [translate]="'modulo.loans.title.principal'">Principal:</span>
      <span fxFlex="60%">{{ loansAccount.principal }} {{loansAccountProductTemplate.currency.DisplaySymbol}}</span>
    </div>
  
    <div fxFlexFill>
      <span fxFlex="40%" [translate]="'modulo.loans.title.loanterm'">Loan term:</span>
      <span fxFlex="60%">{{ loansAccount.loanTermFrequency }}
        {{loansAccount.loanTermFrequencyType | find: loansAccountProductTemplate.termFrequencyTypeOptions:'id':'name'}}</span>
    </div>
  
    <div fxFlexFill>
      <span fxFlex="40%" [translate]="'modulo.loans.title.numrepay'">Number of repayments:</span>
      <span fxFlex="60%">{{ loansAccount.numberOfRepayments }}</span>
    </div>
  
    <div fxFlexFill>
      <span fxFlex="40%" [translate]="'modulo.loans.title.repaid'">Repaid every:</span>
      <span fxFlex="60%">{{loansAccount.repaymentEvery}}
        {{loansAccount.repaymentFrequencyType | find: loansAccountProductTemplate.termFrequencyTypeOptions:'id':'name'}}
        {{loansAccount.repaymentFrequencyNthDayType | find: loansAccountProductTemplate.repaymentFrequencyNthDayTypeOptions:'id': 'name'}}
        {{loansAccount.repaymentFrequencyDayOfWeekType | find: loansAccountProductTemplate.repaymentFrequencyDaysOfWeekTypeOptions:'id': 'name'}}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.repaymentsStartingFromDate">
      <span fxFlex="40%" [translate]="'modulo.loans.title.firstrepayment'">First repayment on:</span>
      <span fxFlex="60%">{{ loansAccount.repaymentsStartingFromDate  | dateFormat }}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.interestChargedFromDate">
      <span fxFlex="40%" [translate]="'modulo.loans.title.interestcharge'">Interest charged from:</span>
      <span fxFlex="60%">{{ loansAccount.interestChargedFromDate  | dateFormat }}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.interestRatePerPeriod">
      <span fxFlex="40%" [translate]="'modulo.loans.title.nominalinterest'">Nominal interest rate:</span>
      <span
        fxFlex="60%">{{loansAccount.interestRatePerPeriod}}&nbsp;&nbsp;{{loansAccountProductTemplate.interestRateFrequencyType.value}}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.interestType">
      <span fxFlex="40%" [translate]="'modulo.loans.title.interestmethod'">Interest method: </span>
      <span fxFlex="60%">{{loansAccount.interestType}}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.isEqualAmortization">
      <span fxFlex="40%" [translate]="'modulo.loans.title.equalamortization'">Is Equal Amortization:</span>
      <span fxFlex="60%">{{loansAccount.isEqualAmortization}}</span>
    </div>
  
    <div fxFlexFill>
      <span fxFlex="40%" [translate]="'modulo.loans.title.amortization'">Amortization</span>
      <span
        fxFlex="60%">{{ loansAccount.amortizationType | find:loansAccountProductTemplate.amortizationTypeOptions:'id':'value' }}</span>
    </div>
  
    <div fxFlexFill>
      <span fxFlex="40%" [translate]="'modulo.loans.title.interestcalculation'">Interest calculation period: </span>
      <span
        fxFlex="60%">{{ loansAccount.interestCalculationPeriodType | find:loansAccountProductTemplate.interestCalculationPeriodTypeOptions:'id':'value'  }}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.allowPartialPeriodInterestCalcualtion">
      <span fxFlex="40%" [translate]="'modulo.loans.title.calculateinterest'">Calculate interest for exact days in partial period:</span>
      <span fxFlex="60%">{{ loansAccount.allowPartialPeriodInterestCalcualtion }}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.inArrearsTolerance">
      <span fxFlex="40%" [translate]="'modulo.loans.title.arrears'">Arrears tolerance: </span>
      <span
        fxFlex="60%">{{loansAccount.inArrearsTolerance}}&nbsp;{{loansAccountProductTemplate.currency.displaySymbol}}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.graceOnInterestCharged">
      <span fxFlex="40%" [translate]="'modulo.loans.title.interestfree'">Interest free period: </span>
      <span fxFlex="60%">{{ loansAccount.graceOnInterestCharged }}</span>
    </div>
  
    <div fxFlexFill>
      <span fxFlex="40%" [translate]="'modulo.loans.title.repaystrategy'">Repayment strategy: </span>
      <span
        fxFlex="60%">{{ loansAccount.transactionProcessingStrategyCode | find:loansAccountTemplate.transactionProcessingStrategyOptions:'code':'name' }}</span>
    </div>
  
    <h3 class="mat-h3" fxFlexFill><span [translate]="'modulo.loans.title.moratorium'">Moratorium</span></h3>
  
    <mat-divider fxFlexFill></mat-divider>
  
    <div fxFlexFill *ngIf="loansAccount.graceOnPrincipalPayment">
      <span fxFlex="40%" [translate]="'modulo.loans.title.onprincipal'">On principal payment: </span>
      <span fxFlex="60%">{{ loansAccount.graceOnPrincipalPayment }}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.graceOnInterestPayment">
      <span fxFlex="40%" [translate]="'modulo.loans.title.oninterest'">On interest payment: </span>
      <span fxFlex="60%">{{ loansAccount.graceOnInterestPayment }}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.graceOnArrearsAgeing">
      <span fxFlex="40%" [translate]="'modulo.loans.title.onarrears'">On Arrears Aging: </span>
      <span fxFlex="60%">{{ loansAccount.graceOnArrearsAgeing }}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.isTopup">
      <span fxFlex="40%" [translate]="'modulo.loans.title.topup'">Is Topup Loan? </span>
      <span fxFlex="60%">{{ loansAccount.isTopup }}</span>
    </div>
  
    <div fxFlexFill>
      <span fxFlex="40%" [translate]="'modulo.loans.title.recalculareinterest'">Recalculate Interest: </span>
      <span fxFlex="60%">{{ (loansAccountProductTemplate?.isInterestRecalculationEnabled? 'modulo.labels.yes' : 'modulo.labels.no') | translate }}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccountProductTemplate?.daysInMonthType">
      <span fxFlex="40%" [translate]="'modulo.loans.title.daysinmonth'">Days in month: </span>
      <span fxFlex="60%">{{ loansAccountProductTemplate?.daysInMonthType.value }}</span>
    </div>
  
    <div fxFlexFill *ngIf="loansAccount.charges.length" fxLayout="row wrap" fxLayout.lt-md="column">
  
      <h3 class="mat-h3" fxFlexFill><span [translate]="'modulo.loans.title.charges'">Charges</span></h3>
  
      <mat-divider fxFlexFill></mat-divider>
  
      <table fxFlexFill class="mat-elevation-z1" mat-table [dataSource]="loansAccount.charges">
  
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef> <span [translate]="'modulo.loans.header.name'">Name </span></th>
          <td mat-cell *matCellDef="let charge">
            {{ charge.name + ', ' + charge.currency.displaySymbol }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="chargeCalculationType">
          <th mat-header-cell *matHeaderCellDef> <span [translate]="'modulo.loans.header.type'">Type </span></th>
          <td mat-cell *matCellDef="let charge">
            {{ charge.chargeCalculationType.value }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="amount">
          <th mat-header-cell *matHeaderCellDef><span [translate]="'modulo.loans.header.amount'"> Amount </span></th>
          <td mat-cell *matCellDef="let charge">
            {{ charge.amount }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="chargeTimeType">
          <th mat-header-cell *matHeaderCellDef> <span [translate]="'modulo.loans.header.collected'">Collected On</span> </th>
          <td mat-cell *matCellDef="let charge">
            {{ charge.chargeTimeType.value }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef><span [translate]="'modulo.loans.header.date'"> Date </span></th>
          <td mat-cell *matCellDef="let charge">
            <span
              *ngIf="charge.chargeTimeType.value === 'Specified due date' || charge.chargeTimeType.value === 'Weekly Fee'">
              {{(charge.dueDate  | dateFormat) || 'Unassigned'}}
            </span>
            <span *ngIf="charge.chargeTimeType.value === 'Monthly Fee' || charge.chargeTimeType.value === 'Annual Fee'">
              {{(charge.feeOnMonthDay  | dateFormat) || 'Unassigned'}}
            </span>
            <span
              *ngIf="!(charge.chargeTimeType.value === 'Monthly Fee' || charge.chargeTimeType.value === 'Annual Fee'
                    || charge.chargeTimeType.value === 'Specified due date' || charge.chargeTimeType.value === 'Weekly Fee')">
              N/A
            </span>
          </td>
        </ng-container>
  
        <tr mat-header-row *matHeaderRowDef="chargesDisplayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: chargesDisplayedColumns;"></tr>
  
      </table>
  
    </div>
  
    <div fxFlexFill *ngIf="loansAccountProductTemplate.overdueCharges.length" fxLayout="row wrap" fxLayout.lt-md="column">
  
      <h3 fxFlex="98%" class="mat-h3"><span [translate]="'modulo.loans.title.charges'">Overdue Charges</span></h3>
  
      <mat-divider fxFlex="98%"></mat-divider>
  
      <table mat-table class="mat-elevation-z1" [dataSource]="loansAccountProductTemplate.overdueCharges">
  
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef><span [translate]="'modulo.loans.header.name'"> Name</span> </th>
          <td mat-cell *matCellDef="let charge"> {{ charge.name }},{{ charge.currency.displaySymbol }} </td>
        </ng-container>
  
        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef><span [translate]="'modulo.loans.header.type'"> Type</span> </th>
          <td mat-cell *matCellDef="let charge"> {{ charge.chargeCalculationType.value }} </td>
        </ng-container>
  
        <ng-container matColumnDef="amount">
          <th mat-header-cell *matHeaderCellDef><span [translate]="'modulo.loans.header.amount'"> Amount </span></th>
          <td mat-cell *matCellDef="let charge"> {{ charge.amount| number }} </td>
        </ng-container>
  
        <ng-container matColumnDef="collectedon">
          <th mat-header-cell *matHeaderCellDef><span [translate]="'modulo.loans.header.collected'"> Collected On </span></th>
          <td mat-cell *matCellDef="let charge"> {{ charge.chargeTimeType.value }} </td>
        </ng-container>
  
        <tr mat-header-row *matHeaderRowDef="overdueChargesDisplayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: overdueChargesDisplayedColumns;"></tr>
      </table>
    </div>
  
  </div>
  
  <div fxLayout="row" class="margin-t" fxLayout.xs="column" fxLayoutAlign="center" fxLayoutGap="2%">
    <button mat-raised-button matStepperPrevious>
      <fa-icon icon="arrow-left"></fa-icon>&nbsp;&nbsp;
      <span [translate]="'labels.buttons.Previous'">Previous</span>
    </button>
    <button mat-raised-button [routerLink]="['../']">
      <span [translate]="'labels.buttons.Cancel'">Cancel</span>
    </button>
    <button mat-raised-button color="primary" (click)="submit.emit()">
      <span [translate]="'labels.buttons.Submit'">Submit</span>
    </button>
  </div>
  