<form [formGroup]="loansAccountTermsForm">

    <div fxLayout="row wrap" fxLayoutGap="2%" fxLayout.lt-md="column">

      <h4 fxFlex="98%" class="mat-h4"><span [translate]="'modulo.loans.title.termoption'">Term Options</span></h4>

      <mat-form-field fxFlex="48%">
        <mat-label><span [translate]="'modulo.loans.labels.loanterm'">Loan Term</span></mat-label>
        <input matInput required formControlName="loanTermFrequency">
        <mat-error *ngIf="loansAccountTermsForm.controls.loanTermFrequency.hasError('required')">
          <span [innerHTML]="'modulo.validations.loantermrequired' |translate">
            Loan Term is <strong>required</strong></span>
        </mat-error>
      </mat-form-field>

      <mat-form-field fxFlex="48%">
        <mat-label><span [translate]="'modulo.loans.labels.frecuency'">Frequency</span></mat-label>
        <mat-select required formControlName="loanTermFrequencyType">
          <mat-option *ngFor="let type of termFrequencyTypeData" [value]="type.id">
            {{ type.value }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="loansAccountTermsForm.controls.loanTermFrequencyType.hasError('required')">
          <span [innerHTML]="'modulo.validations.frecuencyrequired' |translate">
            Frequency is <strong>required</strong></span>
        </mat-error>
      </mat-form-field>

      <mat-form-field fxFlex="48%">
        <mat-label><span [translate]="'modulo.loans.labels.numrepay'">Number of repayments</span></mat-label>
        <input type="number" matInput formControlName="numberOfRepayments">
        <mat-error *ngIf="loansAccountTermsForm.controls.numberOfRepayments.hasError('required')">
          <span [innerHTML]="'modulo.validations.numrepayrequired' |translate">
            Number of repayments is <strong>required</strong></span>
        </mat-error>
      </mat-form-field>

      <mat-form-field fxFlex="48%" (click)="repaymentsPicker.open()">
        <mat-label><span [translate]="'modulo.loans.labels.firstrepay'">First repayment on</span></mat-label>
        <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="repaymentsPicker"
          formControlName="repaymentsStartingFromDate">
        <mat-datepicker-toggle matSuffix [for]="repaymentsPicker"></mat-datepicker-toggle>
        <mat-datepicker #repaymentsPicker></mat-datepicker>
      </mat-form-field>

      <h4 fxFlex="98%" class="mat-h4"><span [translate]="'modulo.loans.title.repaidevery'">Repaid Every</span></h4>

      <mat-form-field fxFlex="48%">
        <mat-label><span [translate]="'modulo.loans.labels.repaid'">Repaid every</span></mat-label>
        <input matInput required formControlName="repaymentEvery"
          [disabled]="!loansAccountProductTemplate?.product.allowAttributeOverrides.repaymentEvery">
        <mat-error *ngIf="loansAccountTermsForm.controls.repaymentEvery.hasError('required')">
          <span [innerHTML]="'modulo.validations.repaidrequired' |translate">
            Repaid every is <strong>required</strong></span>
        </mat-error>
      </mat-form-field>

      <mat-form-field fxFlex="48%">
        <mat-label><span [translate]="'modulo.loans.labels.frecuency'">Frequency</span></mat-label>
        <mat-select formControlName="repaymentFrequencyType" required
          [disabled]="!loansAccountProductTemplate?.product.allowAttributeOverrides.repaymentEvery">
          <mat-option *ngFor="let repaymentFrequencyType of termFrequencyTypeData"
            [value]="repaymentFrequencyType.id">
            {{ repaymentFrequencyType.value }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field fxFlex="48%" *ngIf="loansAccountTermsForm.controls.repaymentFrequencyType.value == 2">
        <mat-label><span [translate]="'select.on'">Select On</span></mat-label>
        <mat-select formControlName="repaymentFrequencyNthDayType">
          <mat-option
            *ngFor="let repaymentFrequencyNthDayType of repaymentFrequencyNthDayTypeData"
            [value]="repaymentFrequencyNthDayType.id">
            {{ repaymentFrequencyNthDayType.value }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field fxFlex="48%" *ngIf="loansAccountTermsForm.controls.repaymentFrequencyType.value == 2">
        <mat-label><span [translate]="'select.day'">Select Day</span></mat-label>
        <mat-select formControlName="repaymentFrequencyDayOfWeekType">
          <mat-option
            *ngFor="let repaymentFrequencyDayOfWeekType of repaymentFrequencyDaysOfWeekTypeData"
            [value]="repaymentFrequencyDayOfWeekType.id">
            {{ repaymentFrequencyDayOfWeekType.value }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field fxFlex="48%" (click)="interestPicker.open()">
        <mat-label><span [translate]="'modulo.loans.labels.interestcharge'">Interest charged from</span></mat-label>
        <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="interestPicker"
          formControlName="interestChargedFromDate">
        <mat-datepicker-toggle matSuffix [for]="interestPicker"></mat-datepicker-toggle>
        <mat-datepicker #interestPicker></mat-datepicker>
      </mat-form-field>

    <ng-container *ngIf="!loansAccountProductTemplate?.isLoanProductLinkedToFloatingRate">

      <mat-form-field fxFlex="48%">
        <mat-label><span [translate]="'modulo.loans.labels.nominalinterest'">Nominal interest rate</span></mat-label>
        <input type="number" matInput formControlName="interestRatePerPeriod">
      </mat-form-field>

        <mat-form-field fxFlex="48%">
          <mat-label><span [translate]="'modulo.loans.labels.interetmethod'">Interest method</span></mat-label>
          <mat-select [disabled]="!loansAccountProductTemplate?.product.allowAttributeOverrides.interestType"
            formControlName="interestType">
            <mat-option *ngFor="let interestType of interestTypeData"
              [value]="interestType.id">
              {{ interestType.value }}
            </mat-option>
          </mat-select>
        </mat-form-field>

    </ng-container>

    

    </div>
    <div fxLayout="row" class="margin-t" fxLayout.xs="column" fxLayoutAlign="center" fxLayoutGap="2%">
      <button mat-raised-button matStepperPrevious>
        <fa-icon icon="arrow-left"></fa-icon>&nbsp;&nbsp;
        <span [translate]="'labels.buttons.Previous'">Previous</span>
      </button>
      <button mat-raised-button matStepperNext>
        <span [translate]="'labels.buttons.Next'">Next</span>&nbsp;&nbsp;
        <fa-icon icon="arrow-right"></fa-icon>
      </button>
    </div>

</form>
